# pandas 入门

## pandas 数据读取
1. pd.read_csv(path, sep = "\t", header = None, names = ['pdate', 'pv', 'uv'])
2. pd.read_excel
3. pd.read_sql


```python
import pandas as pd
import numpy as np
```


```python
name = pd.read_csv("../name_id.xls", sep = "\t", names = ['sample', 'subpopulation'])
name
```

## pandas 的数据结构
* dataframe --> 二维数据、整个表格、 多行多列
* series --> 一维数据、一行一列（类似于字典， 比较好处理）
    * series 由一组数据（不同的数据类型）以及与之相关索引构成

### Series
#### 仅有数据列表即可产生简单的Series


```python
s1 = pd.Series([1, 'a', 5.2, 7])
s1
```


    0      1
    1      a
    2    5.2
    3      7
    dtype: object


```python
s1.index
```


    RangeIndex(start=0, stop=4, step=1)


```python
s1.values
```

    array([1, 'a', 5.2, 7], dtype=object)


#### 在创建Series时指定索引


```python
s2 = pd.Series([1, 'a', 5.2, 7], index = ['a', 'b', 'd', 'e'])
s2
```

    a      1
    b      a
    d    5.2
    e      7
    dtype: object

#### 使用字典创建Series
* 字典的keys为索引， values为值

```python
sdata = {'Ohio' : 35000, 'Texas' : 72000, 'Oregon' : 16000, 'Utah' : 5000}
s3 = pd.Series(sdata)
s3
```

    Ohio      35000
    Texas     72000
    Oregon    16000
    Utah       5000
    dtype: int64

#### 根据标签索引查询数据
* 类似字典dict
* 查询一个值， 返回的是这个值本身
* 同时查询多个值， 返回的是一个Series

```python
s2
```

    a      1
    b      a
    d    5.2
    e      7
    dtype: object

```python
s2['a']
```

    1

```python
type(s2['a'])
```
    int

```python
s2[['b', 'a']]
```


    b    a
    a    1
    dtype: object


```python
type(s2[['b', 'a']])
```


    pandas.core.series.Series



### dataframe

* 每列可以是不同的类型
* 既有行索引index, 也有列索引columns
* 也可以被看做是由Series组成的字典


```python
# 根据多个字典序列创建dataframe
data = {
    'state' : ['Ohio', 'Utah', 'Ohio', 'Texas', 'Ohio'],
    'year' : [2000, 2001, 2002, 2003, 2004],
    'pop' : [1.5, 1.7, 3.6, 2.4, 2.9]
}
df = pd.DataFrame(data)
df
```

</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>year</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ohio</td>
      <td>2000</td>
      <td>1.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Utah</td>
      <td>2001</td>
      <td>1.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ohio</td>
      <td>2002</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Texas</td>
      <td>2003</td>
      <td>2.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ohio</td>
      <td>2004</td>
      <td>2.9</td>
    </tr>
  </tbody>
</table>
</div>



#### dataframe 查询
* 查询一行， 结果是一个Series
* 查询多行， 结果是一个Dataframe


```python
# 查询一行
df.loc[1]
```


    state    Utah
    year     2001
    pop       1.7
    Name: 1, dtype: object


```python
# 查询多行
df.loc[1:3]
```

</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>year</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Utah</td>
      <td>2001</td>
      <td>1.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ohio</td>
      <td>2002</td>
      <td>3.6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Texas</td>
      <td>2003</td>
      <td>2.4</td>
    </tr>
  </tbody>
</table>
</div>


```python
type(df.loc[1:3])
```


    pandas.core.frame.DataFrame

## pandas 数据查询
1. df.loc ， 根据行、列的标签值查询
2. df.iloc ， 根据行、列的数字位置查询
3. df.where
4. df.query
* .loc 既能查询， 又能覆盖写入

### 使用df.loc进行数据查询
* 使用单个label值进行查询
* 使用值列表批量查询
* 使用数值区间进行范围查询
* 使用条件表达式查询
* 调用函数查询

#### 读取数据


```python
na = pd.read_table("../name_id.xls", header = None, names = ['samples', 'subpopulation'])
na
```

</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>samples</th>
      <th>subpopulation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>110</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>111</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>113</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>3</th>
      <td>117</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>120</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>5</th>
      <td>124</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>6</th>
      <td>128</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>7</th>
      <td>129</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>8</th>
      <td>130</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>9</th>
      <td>142</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>10</th>
      <td>143</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>11</th>
      <td>147</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>12</th>
      <td>153</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>13</th>
      <td>161</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>14</th>
      <td>162</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>15</th>
      <td>170</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>16</th>
      <td>171</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>17</th>
      <td>172</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>18</th>
      <td>188</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>19</th>
      <td>194</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>20</th>
      <td>197</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>21</th>
      <td>201</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>22</th>
      <td>203</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>23</th>
      <td>212</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>24</th>
      <td>215</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>25</th>
      <td>218</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>26</th>
      <td>22</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>27</th>
      <td>223</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>28</th>
      <td>225</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>29</th>
      <td>230</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>30</th>
      <td>23</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>31</th>
      <td>237</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>32</th>
      <td>238</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>33</th>
      <td>240</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>34</th>
      <td>241</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>35</th>
      <td>246</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>36</th>
      <td>257</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>37</th>
      <td>260</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>38</th>
      <td>265</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>39</th>
      <td>272</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>40</th>
      <td>274</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>41</th>
      <td>28</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>42</th>
      <td>286</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>43</th>
      <td>287</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>44</th>
      <td>29</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>45</th>
      <td>297</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>46</th>
      <td>309</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>47</th>
      <td>311</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>48</th>
      <td>315</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>49</th>
      <td>33</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>50</th>
      <td>345</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>51</th>
      <td>36</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>52</th>
      <td>43</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>53</th>
      <td>46</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>54</th>
      <td>49</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>55</th>
      <td>52</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>56</th>
      <td>534</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>57</th>
      <td>537</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>58</th>
      <td>538</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>59</th>
      <td>539</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>60</th>
      <td>546</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>61</th>
      <td>5</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>62</th>
      <td>606</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>63</th>
      <td>615</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>64</th>
      <td>637</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>65</th>
      <td>644</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>66</th>
      <td>653</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>67</th>
      <td>655</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>68</th>
      <td>66</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>69</th>
      <td>669</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>70</th>
      <td>681</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>71</th>
      <td>685</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>72</th>
      <td>688</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>73</th>
      <td>71</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>74</th>
      <td>73</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>75</th>
      <td>757</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>76</th>
      <td>76</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>77</th>
      <td>767</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>78</th>
      <td>77</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>79</th>
      <td>819</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>80</th>
      <td>84</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>81</th>
      <td>85</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>82</th>
      <td>863</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>83</th>
      <td>887</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>84</th>
      <td>88</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>85</th>
      <td>89</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>86</th>
      <td>90</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>87</th>
      <td>921</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>88</th>
      <td>94</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>89</th>
      <td>953</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>90</th>
      <td>955</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>91</th>
      <td>956</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>92</th>
      <td>957</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>93</th>
      <td>95</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>94</th>
      <td>959</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>95</th>
      <td>960</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>96</th>
      <td>961</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>97</th>
      <td>963</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>98</th>
      <td>966</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>99</th>
      <td>967</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>100</th>
      <td>969</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>101</th>
      <td>970</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>102</th>
      <td>973</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>103</th>
      <td>974</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>104</th>
      <td>975</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>105</th>
      <td>977</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>106</th>
      <td>980</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>107</th>
      <td>982</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>108</th>
      <td>983</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>109</th>
      <td>985</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>110</th>
      <td>986</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>111</th>
      <td>987</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>112</th>
      <td>988</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>113</th>
      <td>989</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>114</th>
      <td>993</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>115</th>
      <td>CA_1</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>116</th>
      <td>CA_2</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>117</th>
      <td>P55</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>118</th>
      <td>P56</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>119</th>
      <td>MPSM10</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>120</th>
      <td>MPSM11</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>121</th>
      <td>MPSM12</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>122</th>
      <td>MPSM13</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>123</th>
      <td>MPSM15</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>124</th>
      <td>MPSM16</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>125</th>
      <td>MPSM17</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>126</th>
      <td>MPSM18</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>127</th>
      <td>MPSM1</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>128</th>
      <td>MPSM20</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>129</th>
      <td>MPSM21</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>130</th>
      <td>MPSM22</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>131</th>
      <td>MPSM23</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>132</th>
      <td>MPSM24</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>133</th>
      <td>MPSM25</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>134</th>
      <td>MPSM26</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>135</th>
      <td>MPSM27</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>136</th>
      <td>MPSM28</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>137</th>
      <td>MPSM29</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>138</th>
      <td>MPSM2</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>139</th>
      <td>MPSM30</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>140</th>
      <td>MPSM31</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>141</th>
      <td>MPSM32</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>142</th>
      <td>MPSM33</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>143</th>
      <td>MPSM34</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>144</th>
      <td>MPSM35</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>145</th>
      <td>MPSM36</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>146</th>
      <td>MPSM37</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>147</th>
      <td>MPSM38</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>148</th>
      <td>MPSM3</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>149</th>
      <td>MPSM4</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>150</th>
      <td>MPSM5</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>151</th>
      <td>MPSM6</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>152</th>
      <td>MPSM7</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>153</th>
      <td>MPSM8</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>154</th>
      <td>MPSM9</td>
      <td>MP</td>
    </tr>
    <tr>
      <th>155</th>
      <td>553</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>156</th>
      <td>660</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>157</th>
      <td>855</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>158</th>
      <td>856</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>159</th>
      <td>904</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>160</th>
      <td>917</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>161</th>
      <td>920</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>162</th>
      <td>922</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>163</th>
      <td>923</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>164</th>
      <td>926</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>165</th>
      <td>927</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>166</th>
      <td>928</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>167</th>
      <td>929</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>168</th>
      <td>930</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>169</th>
      <td>931</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>170</th>
      <td>932</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>171</th>
      <td>933</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>172</th>
      <td>934</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>173</th>
      <td>935</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>174</th>
      <td>936</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>175</th>
      <td>937</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>176</th>
      <td>938</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>177</th>
      <td>939</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>178</th>
      <td>940</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>179</th>
      <td>941</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>180</th>
      <td>942</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>181</th>
      <td>943</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>182</th>
      <td>944</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>183</th>
      <td>945</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>184</th>
      <td>946</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>185</th>
      <td>947</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>186</th>
      <td>948</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>187</th>
      <td>949</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>188</th>
      <td>950</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>189</th>
      <td>951</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>190</th>
      <td>952</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>191</th>
      <td>MS-1004</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>192</th>
      <td>MS-1008</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>193</th>
      <td>MS-1010</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>194</th>
      <td>MS-1011</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>195</th>
      <td>MS-1012</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>196</th>
      <td>MS-1013</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>197</th>
      <td>MS-1014</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>198</th>
      <td>MS-1015</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>199</th>
      <td>MS-1041</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>200</th>
      <td>MS-1057</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>201</th>
      <td>MS-1154</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>202</th>
      <td>MS-1156</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>203</th>
      <td>MS-1157</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>204</th>
      <td>MS-1161</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>205</th>
      <td>MS-1167</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>206</th>
      <td>MS-1168</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>207</th>
      <td>MS-1169</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>208</th>
      <td>MS-1170</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>209</th>
      <td>MS-1171</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>210</th>
      <td>MS-1172</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>211</th>
      <td>MS-1174</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>212</th>
      <td>MS-1175</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>213</th>
      <td>MS-1176</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>214</th>
      <td>MS-1177</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>215</th>
      <td>MS-1178</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>216</th>
      <td>MS-1184</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>217</th>
      <td>MS-986</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>218</th>
      <td>MS-989</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>219</th>
      <td>MS-994</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>220</th>
      <td>P109</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>221</th>
      <td>P125</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>222</th>
      <td>P132</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>223</th>
      <td>P13</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>224</th>
      <td>P141</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>225</th>
      <td>P144</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>226</th>
      <td>P145</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>227</th>
      <td>P158</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>228</th>
      <td>P15</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>229</th>
      <td>P166</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>230</th>
      <td>P17</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>231</th>
      <td>P18</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>232</th>
      <td>P20</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>233</th>
      <td>P21</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>234</th>
      <td>P29</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>235</th>
      <td>P2</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>236</th>
      <td>P42</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>237</th>
      <td>P43</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>238</th>
      <td>P44</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>239</th>
      <td>P45</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>240</th>
      <td>P50</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>241</th>
      <td>P63</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>242</th>
      <td>P64</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>243</th>
      <td>P65</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>244</th>
      <td>P67</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>245</th>
      <td>P70</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>246</th>
      <td>P7</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>247</th>
      <td>P81</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>248</th>
      <td>P84</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>249</th>
      <td>P8</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>250</th>
      <td>P14</td>
      <td>OG</td>
    </tr>
    <tr>
      <th>251</th>
      <td>P28</td>
      <td>OG</td>
    </tr>
  </tbody>
</table>
```python
# 设定索引为samples
na.set_index('samples', inplace = True)
na.index
```


    Index(['110', '111', '113', '117', '120', '124', '128', '129', '130', '142',
           ...
           'P64', 'P65', 'P67', 'P70', 'P7', 'P81', 'P84', 'P8', 'P14', 'P28'],
          dtype='object', name='samples', length=252)


```python
na
```

</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subpopulation</th>
    </tr>
    <tr>
      <th>samples</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>110</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>111</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>113</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>117</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>120</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>124</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>128</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>129</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>130</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>142</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>143</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>147</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>153</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>161</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>162</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>170</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>171</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>172</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>188</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>194</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>197</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>201</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>203</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>212</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>215</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>218</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>22</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>223</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>225</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>230</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>23</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>237</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>238</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>240</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>241</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>246</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>257</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>260</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>265</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>272</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>274</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>28</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>286</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>287</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>29</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>297</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>309</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>311</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>315</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>33</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>345</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>36</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>43</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>46</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>49</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>52</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>534</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>537</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>538</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>539</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>546</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>606</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>615</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>637</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>644</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>653</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>655</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>66</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>669</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>681</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>685</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>688</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>71</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>73</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>757</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>76</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>767</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>77</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>819</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>84</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>85</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>863</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>887</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>88</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>89</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>90</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>921</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>94</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>953</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>955</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>956</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>957</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>95</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>959</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>960</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>961</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>963</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>966</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>967</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>969</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>970</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>973</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>974</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>975</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>977</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>980</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>982</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>983</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>985</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>986</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>987</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>988</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>989</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>993</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>CA_1</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>CA_2</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>P55</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>P56</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>MPSM10</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM11</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM12</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM13</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM15</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM16</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM17</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM18</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM1</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM20</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM21</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM22</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM23</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM24</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM25</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM26</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM27</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM28</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM29</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM2</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM30</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM31</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM32</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM33</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM34</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM35</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM36</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM37</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM38</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM3</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM4</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM5</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM6</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM7</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM8</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>MPSM9</th>
      <td>MP</td>
    </tr>
    <tr>
      <th>553</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>660</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>855</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>856</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>904</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>917</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>920</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>922</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>923</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>926</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>927</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>928</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>929</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>930</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>931</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>932</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>933</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>934</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>935</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>936</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>937</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>938</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>939</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>940</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>941</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>942</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>943</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>944</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>945</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>946</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>947</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>948</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>949</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>950</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>951</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>952</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1004</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1008</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1010</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1011</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1012</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1013</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1014</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1015</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1041</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1057</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1154</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1156</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1157</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1161</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1167</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1168</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1169</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1170</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1171</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1172</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1174</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1175</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1176</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1177</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1178</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-1184</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-986</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-989</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>MS-994</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P109</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P125</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P132</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P13</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P141</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P144</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P145</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P158</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P15</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P166</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P17</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P18</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P20</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P21</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P29</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P2</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P42</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P43</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P44</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P45</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P50</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P63</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P64</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P65</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P67</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P70</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P7</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P81</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P84</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P8</th>
      <td>WA</td>
    </tr>
    <tr>
      <th>P14</th>
      <td>OG</td>
    </tr>
    <tr>
      <th>P28</th>
      <td>OG</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 将subpopulation列中的CA替换为test
na.loc[:, "subpopulation"] = na["subpopulation"].str.replace("CA", "test").astype('str')
```


```python
na.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subpopulation</th>
    </tr>
    <tr>
      <th>samples</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>110</th>
      <td>test</td>
    </tr>
    <tr>
      <th>111</th>
      <td>test</td>
    </tr>
    <tr>
      <th>113</th>
      <td>test</td>
    </tr>
    <tr>
      <th>117</th>
      <td>test</td>
    </tr>
    <tr>
      <th>120</th>
      <td>test</td>
    </tr>
  </tbody>
</table>
</div>



#### 查询单个值


```python
na
```


#### 使用值列表进行查询

```python
na.loc[['110', '117'], 'subpopulation']
```

    samples
    110    CA
    117    CA
    Name: subpopulation, dtype: object

#### 使用数值区间进行范围查询


```python
na.loc['110':'117', 'subpopulation']
```

    samples
    110    CA
    111    CA
    113    CA
    117    CA
    Name: subpopulation, dtype: object


#### 使用iloc数字索引进行查询


```python
na.iloc[1:20, 0]
```

    samples
    111    CA
    113    CA
    117    CA
    120    CA
    124    CA
    128    CA
    129    CA
    130    CA
    142    CA
    143    CA
    147    CA
    153    CA
    161    CA
    162    CA
    170    CA
    171    CA
    172    CA
    188    CA
    194    CA
    Name: subpopulation, dtype: object

#### 使用条件表达式进行查询


```python
na[na.loc[:,'subpopulation'] == 'CA']
```

#### 调用函数查询


```python
na.loc[lambda na : (na['subpopulation'] == "CA") | (na['subpopulation'] == "OG"), :]
```

</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>subpopulation</th>
    </tr>
    <tr>
      <th>samples</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>110</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>111</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>113</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>117</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>120</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>124</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>128</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>129</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>130</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>142</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>143</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>147</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>153</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>161</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>162</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>170</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>171</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>172</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>188</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>194</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>197</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>201</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>203</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>212</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>215</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>218</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>22</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>223</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>225</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>230</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>23</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>237</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>238</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>240</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>241</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>246</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>257</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>260</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>265</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>272</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>274</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>28</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>286</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>287</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>29</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>297</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>309</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>311</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>315</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>33</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>345</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>36</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>43</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>46</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>49</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>52</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>534</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>537</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>538</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>539</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>546</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>606</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>615</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>637</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>644</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>653</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>655</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>66</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>669</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>681</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>685</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>688</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>71</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>73</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>757</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>76</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>767</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>77</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>819</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>84</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>85</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>863</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>887</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>88</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>89</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>90</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>921</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>94</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>953</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>955</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>956</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>957</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>95</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>959</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>960</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>961</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>963</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>966</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>967</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>969</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>970</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>973</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>974</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>975</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>977</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>980</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>982</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>983</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>985</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>986</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>987</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>988</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>989</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>993</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>CA_1</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>CA_2</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>P55</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>P56</th>
      <td>CA</td>
    </tr>
    <tr>
      <th>P14</th>
      <td>OG</td>
    </tr>
    <tr>
      <th>P28</th>
      <td>OG</td>
    </tr>
  </tbody>
</table>
</div>

